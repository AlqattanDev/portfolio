---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Section from '../components/Section.astro';
import ProjectEntry from '../components/ProjectEntry.astro';
import Skills from '../components/Skills.astro';
import Education from '../components/Education.astro';
import Contact from '../components/Contact.astro';
import profile from '../data/profile.json';
import type { Project } from '@/types';

// Normalize projects to ensure metrics are available in expected shape
const normalizedProjects = (profile.projects || []).map((p: Project) => ({
  ...p,
  metrics: p.metrics ?? {
    scale: p.scale,
    security: p.security,
    performance: p.performance,
    innovation: p.innovation,
  },
}));
---

<Layout>
  <Header profile={profile} />

  <Section id="contact-info" title="Contact Info">
    <Contact profile={profile} />
  </Section>

  <Section id="project-manifest" title="Project Manifest">
    {normalizedProjects.map((project) => <ProjectEntry project={project} />)}
  </Section>

  <Section id="skill-matrix" title="Skill Matrix">
    <Skills skills={profile.skills} />
  </Section>

  <Section id="education-log" title="Education Log">
    <Education edu={profile.education} />
  </Section>

  <div class="footer-info">
    <span class="checksum">Checksum: {profile.checksum}</span>
    <span class="color-scheme" id="colorSchemeDisplay">Scheme: Matrix Rain</span
    >
  </div>
</Layout>
